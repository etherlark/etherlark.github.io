(function(t){function e(e){for(var n,o,i=e[0],l=e[1],c=e[2],p=0,m=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(m.length)m.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var t,e=0;e<s.length;e++){for(var r=s[e],n=!0,i=1;i<r.length;i++){var l=r[i];0!==a[l]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=r[0]))}return t}var n={},a={app:0},s=[];function o(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=n,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var u=l;s.push([1,"chunk-vendors"]),r()})({0:function(t,e){},"034f":function(t,e,r){"use strict";var n=r("f8a4"),a=r.n(n);a.a},"055b":function(t,e,r){"use strict";var n=r("e1bb"),a=r.n(n);a.a},"05c0":function(t,e,r){"use strict";var n=r("5a12"),a=r.n(n);a.a},"08c6":function(t,e,r){"use strict";var n=r("6877"),a=r.n(n);a.a},"08f4":function(t,e,r){"use strict";var n=r("17b4"),a=r.n(n);a.a},"0b41":function(t,e,r){"use strict";var n=r("f534"),a=r.n(n);a.a},"0f9b":function(t,e,r){},1:function(t,e,r){t.exports=r("56d7")},10:function(t,e){},"104d":function(t,e,r){"use strict";var n=r("7c84"),a=r.n(n);a.a},"12b6":function(t,e,r){"use strict";var n=r("f3bb"),a=r.n(n);a.a},"17b4":function(t,e,r){},2:function(t,e){},2940:function(t,e,r){"use strict";var n=r("e5c8"),a=r.n(n);a.a},3:function(t,e){},"38ac":function(t,e,r){},"3a5e":function(t,e,r){"use strict";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"loading"})},a=[],s={name:"Loading"},o=s,i=(r("7f16"),r("4023")),l=Object(i["a"])(o,n,a,!1,null,"38280d7f",null);e["a"]=l.exports},4:function(t,e){},"40c8":function(t,e,r){"use strict";var n=r("7870"),a=r.n(n);a.a},"441f":function(t,e,r){},"4e3e":function(t,e,r){"use strict";var n=r("441f"),a=r.n(n);a.a},5:function(t,e){},5611:function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("a133"),r("ed0d"),r("f09c"),r("e117");var n=r("0261"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("b-navbar",{attrs:{toggleable:"lg",type:"light",variant:"info",id:"navmanu"}},[n("b-navbar-brand",{on:{click:t.backtoindex}},[n("img",{staticClass:"d-inline-block align-top",attrs:{src:r("d7a1"),alt:"SteemJiang"}})]),n("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",{staticClass:"ml-auto"},[n("router-link",{attrs:{to:"/"}},[t._v("首页")]),n("router-link",{attrs:{to:"/post"}},[t._v("发布")]),n("router-link",{attrs:{to:"/wallet"}},[t._v("钱包")]),t.$store.state.nickname?n("div",[n("a",{attrs:{href:"#"}},[t._v("@"+t._s(t.$store.state.nickname))]),n("a",{attrs:{href:"#"},on:{click:t.logout}},[t._v("注销")])]):n("div",[n("router-link",{attrs:{to:"/login"}},[t._v("登录")])],1)],1)],1)],1),n("router-view"),n("Footer")],1)},s=[],o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"myfooter"},[r("b-container",{staticClass:"bv-example-row"},[r("b-row",[r("b-col",[r("router-link",{attrs:{to:"/about"}},[t._v("关于百灵界")])],1),r("b-col",[r("a",{attrs:{target:"_blank",href:"https://github.com/etherjiang/etherjiang.github.io"}},[t._v("Github")])]),r("b-col",[r("a",{attrs:{target:"_blank",href:"https://starnote.github.io/#/@lemooljiang/qqe4s"}},[t._v("开发手册")])])],1),r("b-row",[r("b-col",[r("a",{attrs:{target:"_blank",href:"https://steemjiang.com/trend/@lemooljiang/0t9hr"}},[t._v("新手指南")])]),r("b-col",[r("a",{attrs:{target:"_blank",href:"https://github.com/ethereum/go-ethereum"}},[t._v("Go-ethereum")])]),r("b-col",[r("a",{attrs:{target:"_blank",href:"https://github.com/bekatom/awesome-ethereum"}},[t._v("AwesomeEth")])])],1)],1),r("p",{staticClass:"info"},[t._v("Copyright©2019 百灵界是一个基于以太坊的区块链世界 @lemooljiang创建 QQ:497867999")])],1)},i=[],l={name:"Footer"},c=l,u=(r("104d"),r("4023")),p=Object(u["a"])(c,o,i,!1,null,"03b9d8d5",null),m=p.exports,d=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"category"}},[r("h1",[t._v("专栏")]),r("div",{attrs:{id:"titlename"}},[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 cate",attrs:{id:"inline-form-input-name",placeholder:"请输入专栏名"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 cate",attrs:{id:"inline-form-input-name",placeholder:"请输入tag"},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}})],1),r("div",{staticClass:"catrbtn"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.add}},[t._v("添加")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.save}},[t._v("保存")]),r("em",[t._v("(专栏名可以随意取，tag则必须为文章包含的tag!)")])],1),t._l(t.category,(function(e){return r("div",{staticClass:"zhuanlan"},[r("p",{staticClass:"title"},[t._v("专栏: "+t._s(e.name)+" tag: "+t._s(e.tag)+" "),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(r){return t.del(e.tag)}}},[t._v("删除")])],1),t._l(t.getCategory(e.tag),(function(e){return r("div",[r("router-link",{attrs:{to:"/article/"+e.permlink}},[r("p",{staticClass:"posttime"},[t._v(t._s(t._f("formatTime")(e.created)))]),t._v(" "+t._s(e.title))])],1)}))],2)}))],2)},f=[],h=(r("dbb3"),r("3466"),r("b130"),r("ea69"),r("053b"),r("90aa"),{name:"Category",data:function(){return{newpost:[],name:"",tag:"",category:[{name:"轻量的博客",tag:"steemjiang"}]}},methods:{add:function(){var t={name:this.name,tag:this.tag};this.category.push(t),this.name=this.tag=""},save:function(){var t=JSON.stringify(this.category);localStorage.setItem("category",t)},del:function(t){this.category.splice(this.category.findIndex((function(e){return e.tag===t})),1)},getCategory:function(t){var e=this.$store.state.posts;return e.filter((function(e){var r=e.json_metadata,n=JSON.parse(r);if(n.tags.includes(t))return e}))}},filters:{formatTime:function(t){return t.substring(0,10)}},mounted:function(){null==localStorage.getItem("category")?this.category=[{name:"轻量的博客",tag:"steemjiang"},{name:"比特币",tag:"bitcoin"}]:this.category=JSON.parse(localStorage.getItem("category"))}}),g=h,v=(r("e1b2"),Object(u["a"])(g,d,f,!1,null,"c73a4868",null)),b=v.exports,y=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"reply"},[r("h5",[t._v("评论")]),t._l(t.replies,(function(t){return r("div",[r("Replylist",{attrs:{parentmsg:t}})],1)}))],2)},k=[],_=(r("fe59"),r("e18c"),r("1c2e"),r("96db"),r("08ba"),r("af86"),r("b449"),r("5d83")),x=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"item"},[r("span",{staticClass:"child"},[r("span",{staticClass:"author"},[t._v("@"+t._s(t.parentmsg.author))]),r("mavon-editor",{staticClass:"replymd",attrs:{value:t.parentmsg.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}})],1),t.parentmsg.author==this.$store.state.username?r("div",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.edit(t.parentmsg)}}},[t._v("编辑")]),t.editFlag?r("div",[r("div",{attrs:{id:"main"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.refresh(t.parentmsg)}}},[t._v("更新")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e()],1):r("div",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.reply(t.parentmsg.author,t.parentmsg.permlink,t.parentmsg)}}},[t._v("回复")])],1),t.replyFlag?r("div",[r("div",{attrs:{id:"main2"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.replypost(t.parentmsg.author,t.parentmsg.permlink,t.parentmsg)}}},[t._v("提交")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e(),t.parentmsg.child?r("ul",{staticClass:"child"},t._l(t.parentmsg.child,(function(t,e){return r("Replylist",{key:e,attrs:{parentmsg:t}})})),1):t._e()])},w=[],$=(r("e35a"),r("0d7a"),{name:"Replylist",data:function(){return{text:"",replyFlag:!1,editFlag:!1,key:""}},methods:{reply:function(t,e,r){this.replyFlag=!0,0==r.children&&this.$set(r,"child",[])},replypost:function(t,e,r){this.replyFlag=!1;var n=this.$store.state.password,a=this.$store.state.username,s=this.getstr(),o="",i=this.text,l=["cn","steemjiang"],c={tags:l,app:"steemit/1.0",format:"markdown"},u={parent_author:t,parent_permlink:e,title:o,author:a,permlink:s,body:i,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(c)};r.child.push(u),this.postToSteem(n,t,e,a,s,o,i,c)},edit:function(t){this.editFlag=!0,this.text=t.body},refresh:function(t){this.editFlag=!1,this.$set(t,"body",this.text);var e=this.$store.state.password,r=this.$store.state.username,n=t.parent_author,a=t.parent_permlink,s=t.permlink,o=t.title,i=this.text,l=t.json_metadata;this.postToSteem(e,n,a,r,s,o,i,l);var c=this.$route.params.permlink,u=c+"length",p=parseInt(localStorage.getItem(u));p--,localStorage.setItem(u,p.toString())},clear:function(){this.replyFlag=!1,this.editFlag=!1,this.text=""},uploadimg:function(t,e){this.imgAdd(t,e)}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},props:["parentmsg"]}),S=$,C=(r("c073"),Object(u["a"])(S,x,w,!1,null,"71f929ba",null)),O=C.exports,j={name:"Reply",data:function(){return{firstreplies:[],replies:[],temp:[],keys:[],res:[]}},methods:{getRepliesFromDB:function(){var t=this.$store.state.db,e=this.$store.state.username+"reply",r=t.transaction([e],"readwrite"),n=r.objectStore(e),a=[];return new Promise((function(t){n.openCursor().onsuccess=function(e){var r=e.target.result;r?(a.push(r.value),r.continue()):t(a)},n.openCursor().onerror=function(t){console.dir(t)}}))},filterRepliesDB:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=this.firstreplies;a.forEach((function(a){a.parent_author==t&a.parent_permlink==e&&(n.push(a),a.children>0&&r.filterRepliesDB(a.author,a.permlink,a.child=[]))})),this.replies=n},filterRepliesTemp:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=this,a=n.res;a.forEach((function(a){a.parent_author==t&a.parent_permlink==e&&(r.push(a),a.children>0&&n.filterRepliesTemp(a.author,a.permlink,a.child=[]))})),n.temp=r},searchRepliyKeys:function(t){var e=this,r=this.$store.state.db,n=this.$store.state.username+"reply",a=r.transaction([n],"readwrite"),s=a.objectStore(n);return new Promise((function(r){s.openCursor().onsuccess=function(n){var a=n.target.result;a?(t.forEach((function(t){a.value.permlink==t.permlink&&e.keys.push(a.key)})),a.continue()):r(),s.openCursor().onerror=function(t){console.dir(t)}}}))},delreplies:function(){var t=this.keys,e=this.$store.state.db,r=this.$store.state.username+"reply",n=e.transaction([r],"readwrite"),a=n.objectStore(r);return new Promise((function(e){t.forEach((function(t){a.delete(t)})),e()}))},saveReplies:function(){var t=this.$store.state.db,e=this.$store.state.username+"reply",r=t.transaction([e],"readwrite");r.oncomplete=function(t){console.log("事务操作完成")},r.onerror=function(t){console.log(311,"事务操作出错"),console.dir(t)},r.onsuccess=function(t){console.log("事务操作成功")};for(var n=r.objectStore(e),a=this.res,s=0;s<a.length;s++)n.add(a[s])}},watch:{temp:function(){this.replies=this.temp}},mounted:function(){var t=this,e=this.$store.state.username,r=this.$route.params.permlink,n=r+"length";function a(t,e){return s.apply(this,arguments)}function s(){return s=Object(_["a"])(regeneratorRuntime.mark((function e(r,n){var s,o,i,l=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=l.length>2&&void 0!==l[2]?l[2]:[],e.next=3,t.steem.api.getContentRepliesAsync(r,n);case 3:return o=e.sent,i=[],o.forEach((function(t){s.push(t),t.children>0&&i.push(a(t.author,t.permlink,s))})),e.next=8,Promise.all(i);case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}if(null==localStorage.getItem(n)){var o=function(){var s=Object(_["a"])(regeneratorRuntime.mark((function s(){var o,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,a(e,r);case 2:o=s.sent,t.res=o,t.filterRepliesTemp(e,r),i=o.length.toString(),localStorage.setItem(n,i),t.saveReplies();case 8:case"end":return s.stop()}}),s)})));return function(){return s.apply(this,arguments)}}();o()}else{var i=function(){var n=Object(_["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getRepliesFromDB();case 2:t.firstreplies=n.sent,t.filterRepliesDB(e,r);case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),l=function(){var s=Object(_["a"])(regeneratorRuntime.mark((function s(){var o,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,a(e,r);case 2:if(o=s.sent,i=parseInt(localStorage.getItem(n)),!(i<o.length)){s.next=13;break}return t.res=o,t.filterRepliesTemp(e,r),s.next=9,t.searchRepliyKeys(o);case 9:return s.next=11,t.delreplies();case 11:t.saveReplies(),localStorage.setItem(n,o.length.toString());case 13:case"end":return s.stop()}}),s)})));return function(){return s.apply(this,arguments)}}();setTimeout(i,200),setTimeout(l,300)}},components:{Replylist:O}},F=j,R=(r("838e"),Object(u["a"])(F,y,k,!1,null,"10244a47",null)),A=R.exports,P={name:"App",data:function(){return{parmsg:"这是父数据"}},methods:{backtoindex:function(){this.$router.push({path:"/"})},logout:function(){this.$store.commit("clearUser")}},filters:{formatTime:function(t){return t.substring(0,10)}},components:{Footer:m,Category:b,Reply:A}},T=P,D=(r("034f"),Object(u["a"])(T,a,s,!1,null,null,null)),I=D.exports,E=r("1860"),L=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"login"},[r("h2",[t._v("用户登录")]),t.flag?r("div",[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 user",attrs:{id:"inline-form-input-name",placeholder:"设置呢称(任意长度的任意字符，不能为空)"},model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}}),r("br"),t._v(" 地址： "+t._s(t.addr)+" "),r("div",{staticClass:"loginbtn"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.login}},[t._v("登录")])],1)],1):t._e(),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1)],1)},B=[],N=r("3a5e"),J={name:"Login",data:function(){return{nickname:"",addr:"",password:"",isLoading:!1,flag:!0}},methods:{login:function(){this.flag=!1,""!==this.nickname&&""!==this.addr?(this.$store.commit("saveUser",{nickname:this.nickname,addr:this.addr}),this.$router.push({path:"/"})):(alert("呢称或地址不能为空！"),this.flag=!0)}},components:{Loading:N["a"]},mounted:function(){var t=this;function e(){return r.apply(this,arguments)}function r(){return r=Object(_["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.enable();case 2:r=e.sent,t.addr=r[0],console.log(124,addr);case 5:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}e()}},q=J,K=(r("f47f"),Object(u["a"])(q,L,B,!1,null,"d469c140",null)),H=K.exports,M=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"article"},[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 search",attrs:{id:"inline-form-input-name",placeholder:"搜索"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),t._l(t.search(t.keywords),(function(e){return r("div",{staticClass:"content"},[r("router-link",{attrs:{to:"/trend/"+e.addr+"/"+e.permlink}},[r("b-img",{staticClass:"courseimg",attrs:{src:t._f("takeImage")(e.body),fluid:""}})],1),r("div",{staticClass:"title"},[r("router-link",{attrs:{to:"/trend/"+e.addr+"/"+e.permlink}},[r("span",{staticStyle:{"font-size":"1.2rem"}},[t._v(t._s(e.title))]),r("br")]),r("p",{staticClass:"posttime"},[t._v("@"+t._s(e.nickname)+" ("+t._s(t._f("formatAddr")(e.addr))+") "),r("span",{staticStyle:{"margin-left":"1rem"}},[t._v(t._s(t._f("formatTime")(e.created)))])])],1),r("p",{staticStyle:{padding:"0 1rem 1rem 1rem"}},[t._v(t._s(t._f("abstractFn")(e.body))+" ......")])],1)})),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1)],2)},U=[],W=(r("77ad"),r("fe8a"),r("f4e3"),r("5e9f"),{name:"Index",data:function(){return{keywords:"",posts:[],author:"",permlink:"",isLoading:!0}},methods:{search:function(t){var e=this.$store.state.hot;return e.filter((function(e){if(e.title.includes(t))return e}))},getHot:function(){var t=this,e={tag:"hive-180932",limit:20};this.steem.api.getDiscussionsByTrending(e,(function(e,r){t.posts=r,t.author=r[r.length-1].author,t.permlink=r[r.length-1].permlink,t.$store.commit("saveHot",r),t.isLoading=!1}))},getNext:function(){var t=this;t.isLoading=!0;var e={tag:"hive-180932",limit:20,start_author:this.author,start_permlink:this.permlink};this.steem.api.getDiscussionsByTrending(e,(function(e,r){r.forEach((function(e){e.permlink!=t.permlink&&t.posts.push(e)})),t.author=r[r.length-1].author,t.permlink=r[r.length-1].permlink,t.$store.commit("saveHot",t.posts),t.isLoading=!1,1==r.length&&alert("没有更多了！")}))},utf8ArrayToStr:function(t){var e,r,n,a,s,o;e="",n=t.length,r=0;while(r<n)switch(a=t[r++],a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(a);break;case 12:case 13:s=t[r++],e+=String.fromCharCode((31&a)<<6|63&s);break;case 14:s=t[r++],o=t[r++],e+=String.fromCharCode((15&a)<<12|(63&s)<<6|(63&o)<<0);break}return e}},components:{Loading:N["a"]},mounted:function(){var t=this,e=this.$store.state.instance;function r(){return n.apply(this,arguments)}function n(){return n=Object(_["a"])(regeneratorRuntime.mark((function r(){var n,a,s,o,i,l,c,u,p,m,d,f,h,g,v;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(0!=t.$store.state.hot){r.next=59;break}if(console.log(1112,"从网络取值！"),0!==Object.keys(e).length){r.next=36;break}return r.next=5,t.axios.get("Post.json");case 5:return n=r.sent,a=t.TruffleContract(n.data),a.setProvider(t.web3Provider),r.next=10,a.deployed();case 10:return s=r.sent,t.$store.commit("saveInstance",s),r.next=14,s.id();case 14:o=r.sent,console.log(555,o),i=[],l=1;case 18:if(!(l<=o)){r.next=31;break}return r.next=21,s.get(l);case 21:return c=r.sent,console.log(56e3,c[0]),r.next=25,t.ipfs.cat(c[0]);case 25:u=r.sent,p=t.utf8ArrayToStr(u),i.push(JSON.parse(p));case 28:l++,r.next=18;break;case 31:console.log(899,i),t.isLoading=!1,t.$store.commit("saveHot",i.reverse()),r.next=57;break;case 36:return r.next=38,e.id();case 38:m=r.sent,d=[],f=1;case 41:if(!(f<=m.words[0])){r.next=53;break}return r.next=44,e.get(f);case 44:return h=r.sent,r.next=47,t.ipfs.cat(h[0]);case 47:g=r.sent,v=t.utf8ArrayToStr(g),d.push(JSON.parse(v));case 50:f++,r.next=41;break;case 53:console.log(7799,d),t.posts=d,t.isLoading=!1,t.$store.commit("saveHot",d);case 57:r.next=60;break;case 59:t.isLoading=!1;case 60:case"end":return r.stop()}}),r)}))),n.apply(this,arguments)}r()},filters:{formatTime:function(t){return t.substring(0,10)},formatAddr:function(t){return t.substring(0,6)+"..."+t.substring(38)},takeImage:function(t){var e=/!\[(.*?)\]\((.*?)\)/,r=t.match(e);if(null!==r)return r[2]},abstractFn:function(t){if(t){var e=t.replace(/(\*\*|__)(.*?)(\*\*|__)/g,"").replace(/\!\[[\s\S]*?\]\([\s\S]*?\)/g,"").replace(/\([\s\S]*?\)/g,"").replace(/<\/?.+?\/?>/g,"").replace(/http.*\w/g,"").replace(/(\*)(.*?)(\*)/g,"").replace(/`{1,2}[^`](.*?)`{1,2}/g,"").replace(/```([\s\S]*?)```[\s]*/g,"").replace(/\~\~(.*?)\~\~/g,"").replace(/[\s]*[-\*\+]+(.*)/g,"").replace(/[\s]*[0-9]+\.(.*)/g,"").replace(/(#+)(.*)/g,"").replace(/(>+)(.*)/g,"").replace(/\r\n/g,"").replace(/\n/g,"");return e.slice(0,180)}return""}}}),z=W,G=(r("08c6"),Object(u["a"])(z,M,U,!1,null,"031db4fc",null)),Q=G.exports,X=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("h1",[t._v(t._s(t.post.title))]),r("p",{staticClass:"posttime"},[t._v("@"+t._s(t.post.nickname)+" ("+t._s(t._f("formatAddr")(t.post.addr))+") "),r("span",{staticStyle:{"margin-left":"1rem"}},[t._v(t._s(t._f("formatTime")(t.post.created)))])]),r("mavon-editor",{attrs:{value:t.post.body+"<br><br>"+t.keywords+t.post.json_metadata.keywords.join("　"),subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,scrollStyle:t.prop.scrollStyle}})],1)},Y=[],Z=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"reply"},[r("h5",[t._v("评论")]),t._l(t.replies,(function(t){return r("div",[r("OtherReplylist",{attrs:{parentmsg:t}})],1)}))],2)},V=[],tt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"item"},[r("span",{staticClass:"child"},[r("span",{staticClass:"author"},[t._v("@"+t._s(t.parentmsg.author))]),r("mavon-editor",{staticClass:"replymd",attrs:{value:t.parentmsg.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}})],1),t.parentmsg.author==this.$store.state.username?r("div",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.edit(t.parentmsg)}}},[t._v("编辑")]),t.editFlag?r("div",[r("div",{attrs:{id:"main"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.refresh(t.parentmsg)}}},[t._v("更新")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e()],1):r("div",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.reply(t.parentmsg.author,t.parentmsg.permlink,t.parentmsg)}}},[t._v("回复")])],1),t.replyFlag?r("div",[r("div",{attrs:{id:"main2"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.replypost(t.parentmsg.author,t.parentmsg.permlink,t.parentmsg)}}},[t._v("提交")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e(),t.parentmsg.child?r("ul",{staticClass:"child"},t._l(t.parentmsg.child,(function(t,e){return r("OtherReplylist",{key:e,attrs:{parentmsg:t}})})),1):t._e()])},et=[],rt={name:"OtherReplylist",data:function(){return{text:"",replyFlag:!1,editFlag:!1,permlink:"",key:""}},methods:{reply:function(t,e,r){this.replyFlag=!0,0==r.children&&this.$set(r,"child",[])},replypost:function(t,e,r){this.replyFlag=!1;var n=this.$store.state.password,a=this.$store.state.username,s=this.getstr(),o="",i=this.text,l=["cn","steemjiang"],c={tags:l,app:"steemit/1.0",format:"markdown"},u={parent_author:t,parent_permlink:e,title:o,author:a,permlink:s,body:i,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(c)};r.child.push(u),this.postToSteem(n,t,e,a,s,o,i,c)},edit:function(t){this.editFlag=!0,this.text=t.body},refresh:function(t){this.editFlag=!1,this.$set(t,"body",this.text);var e=this.$store.state.password,r=this.$store.state.username,n=t.parent_author,a=t.parent_permlink,s=t.permlink,o=t.title,i=this.text,l=t.json_metadata;this.postToSteem(e,n,a,r,s,o,i,l)},clear:function(){this.replyFlag=!1,this.editFlag=!1,this.text=""},uploadimg:function(t,e){this.imgAdd(t,e)}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},props:["parentmsg"]},nt=rt,at=(r("a0da"),Object(u["a"])(nt,tt,et,!1,null,"799a3292",null)),st=at.exports,ot={name:"OtherReply",data:function(){return{replies:[]}},methods:{delreplies:function(){var t=this,e=t.keys,r=t.$store.state.db,n=t.$store.state.username+"reply",a=r.transaction([n],"readwrite"),s=a.objectStore(n);return new Promise((function(t){e.forEach((function(t){s.delete(t)})),t()}))}},watch:{otherreply:function(){this.replies.push(this.otherreply)}},mounted:function(){var t=this,e=this.$route.params.author,r=this.$route.params.permlink;function n(t,e){return a.apply(this,arguments)}function a(){return a=Object(_["a"])(regeneratorRuntime.mark((function e(r,a){var s,o,i,l=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=l.length>2&&void 0!==l[2]?l[2]:[],e.next=3,t.steem.api.getContentRepliesAsync(r,a);case 3:return o=e.sent,i=[],o.forEach((function(t){s.push(t),t.children>0&&i.push(n(t.author,t.permlink,t.child=[]))})),e.next=8,Promise.all(i);case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}n(e,r).then((function(e){t.replies=e}))},props:["otherreply"],components:{OtherReplylist:st}},it=ot,lt=(r("a4c8"),Object(u["a"])(it,Z,V,!1,null,"4a5a9d63",null)),ct=lt.exports,ut={name:"Trend",data:function(){return{db:{},post:{},data:"",flag:localStorage.getItem(this.$route.params.permlink),replyFlag:!1,text:"",areply:{},keywords:"关键词：　"}},methods:{addCollection:function(){var t=this.$store.state.db,e=this.$store.state.username+"collection",r=t.transaction([e],"readwrite");r.oncomplete=function(t){console.log("事务操作完成")},r.onerror=function(t){console.log("事务操作出错"),console.dir(t)},r.onsuccess=function(t){console.log("事务操作成功")};var n=r.objectStore(e),a=this.post;n.add(a);var s=this.$route.params.permlink;localStorage.setItem(s,"steemjiang"),this.flag=localStorage.getItem(this.$route.params.permlink)},reply:function(){this.replyFlag=!0},replypost:function(){this.replyFlag=!1;var t=this.$store.state.password,e=this.$route.params.author,r=this.$route.params.permlink,n=this.$store.state.username,a=this.getstr(),s="",o=this.text,i=["cn","steemjiang"],l={tags:i,app:"steemit/1.0",format:"markdown"};this.postToSteem(t,e,r,n,a,s,o,l);var c={parent_author:e,parent_permlink:r,title:s,author:n,permlink:a,body:o,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(l)};this.areply=c,this.text=""},clear:function(){this.replyFlag=!1,this.text=""},uploadimg:function(t,e){this.imgAdd(t,e)}},watch:{flag:function(t){return t}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},mounted:function(){var t=this;if(0!=this.$store.state.hot){var e=this.$store.state.hot;e.forEach((function(e){e.permlink==t.$route.params.permlink&&(t.post=e)}))}},filters:{formatTime:function(t){return t.substring(0,10)},formatAddr:function(t){return t.substring(0,6)+"..."+t.substring(38)}},components:{OtherReply:ct}},pt=ut,mt=(r("0b41"),Object(u["a"])(pt,X,Y,!1,null,"4a0a39a0",null)),dt=mt.exports,ft=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"maintop"}},[t.flag?r("div",[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 title",attrs:{id:"inline-form-input-name",placeholder:"请输入标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),r("div",{attrs:{id:"main"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.body,callback:function(e){t.body=e},expression:"body"}})],1),r("br"),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{placeholder:"输入关键词，以空格分隔"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),r("div",{staticClass:"btn"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.post}},[t._v("提交")])],1)],1):t._e(),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1)],1)},ht=[],gt=r("7f3b"),vt=gt["a"],bt=(r("bb39"),Object(u["a"])(vt,ft,ht,!1,null,"6f70576b",null)),yt=bt.exports,kt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"maintop"}},[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 title",attrs:{placeholder:"请输入标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),r("div",{attrs:{id:"main"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.body,callback:function(e){t.body=e},expression:"body"}})],1),r("br"),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"inline-form-input-name",placeholder:"tags  (输入英文标签，以空格分隔)"},model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}}),r("div",{staticClass:"btn"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.post}},[t._v("提交")])],1)],1)},_t=[],xt=(r("9302"),r("6db4"),{name:"Edit",data:function(){return{db:{},posts:[],body:"",category:"",title:"",tags:"",key:""}},methods:{uploadimg:function(t,e){this.imgAdd(t,e)},searchKey:function(){var t=this,e=this.$route.params.permlink,r=this.$store.state.db,n=this.$store.state.username,a=r.transaction([n],"readwrite"),s=a.objectStore(n);s.openCursor().onsuccess=function(r){var n=r.target.result;n&&(n.value.permlink==e&&(t.key=n.key,t.body=n.value.body,t.category=n.value.category,t.title=n.value.title,t.tags=JSON.parse(n.value.json_metadata).tags.join(" ")),n.continue()),s.openCursor().onerror=function(t){console.dir(t)}}},post:function(){var t=this.$store.state.password,e="",r=this.category,n=this.$store.state.username,a=this.$route.params.permlink,s=this.title,o=this.body,i=this.tags.trim().split(/\s+/),l={tags:i,dapp:"steemjiang",format:"markdown"};this.postToSteem(t,e,r,n,a,s,o,l);var c={id:this.key,title:s,author:n,category:this.category,permlink:a,body:o,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(l)},u=this,p=this.$store.state.db,m=this.$store.state.username;function d(){return new Promise((function(t){var e=p.transaction([m],"readwrite");e.oncomplete=function(t){console.log("事务操作完成")},e.onerror=function(t){console.log("事务操作出错"),console.dir(t)},e.onsuccess=function(t){console.log("事务操作成功")};var r=e.objectStore(m);r.put(c),t()}))}function f(){return h.apply(this,arguments)}function h(){return h=Object(_["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d();case 2:return t.next=4,u.getAllPosts(p);case 4:e=t.sent,u.$store.commit("savePosts",e.reverse()),u.$router.push({path:"/blog/"+a});case 7:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}f()}},mounted:function(){var t=this;function e(){return r.apply(this,arguments)}function r(){return r=Object(_["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.$store.state.username){e.next=16;break}if(0!=t.$store.state.posts){e.next=14;break}return e.next=4,t.initDatabase();case 4:return r=e.sent,t.$store.commit("saveDB",r),e.next=8,t.getAllPosts(r);case 8:return n=e.sent,t.$store.commit("savePosts",n.reverse()),e.next=12,t.searchKey();case 12:e.next=16;break;case 14:return e.next=16,t.searchKey();case 16:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}e()}}),wt=xt,$t=(r("9e0d"),Object(u["a"])(wt,kt,_t,!1,null,"d770c6cc",null)),St=$t.exports,Ct=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"article"},[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 search",attrs:{id:"inline-form-input-name",placeholder:"搜索"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),t._l(t.search(t.keywords),(function(e){return r("div",{staticClass:"content"},[r("router-link",{attrs:{to:"/feed/@"+e.author+"/"+e.permlink}},[r("b-img",{staticClass:"courseimg",attrs:{src:t._f("takeImage")(e.body),fluid:""}})],1),r("div",{staticClass:"title"},[r("router-link",{attrs:{to:"/feed/@"+e.author+"/"+e.permlink}},[r("span",{staticStyle:{"font-size":"1.2rem"}},[t._v(t._s(e.title))]),r("br")]),r("p",{staticClass:"posttime"},[t._v("@"+t._s(e.author)+" "+t._s(t._f("formatTime")(e.created)))])],1),r("p",{staticStyle:{padding:"0 1rem 1rem 1rem"}},[t._v(t._s(t._f("abstractFn")(e.body))+" ......")])],1)})),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1),r("div",{staticClass:"btn"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.getNext}},[t._v("查看更多")])],1)],2)},Ot=[],jt={name:"Feeds",data:function(){return{keywords:"",posts:[],author:"",permlink:"",isLoading:!0}},methods:{search:function(t){var e=this.posts;return e.filter((function(e){if(e.title.includes(t))return e}))},getFeed:function(){var t=this,e={tag:this.$store.state.username,limit:20};this.steem.api.getDiscussionsByFeed(e,(function(e,r){t.posts=r,t.author=r[r.length-1].author,t.permlink=r[r.length-1].permlink,t.$store.commit("saveFeed",r),t.isLoading=!1}))},getNext:function(){var t=this;t.isLoading=!0;var e={tag:this.$store.state.username,limit:20,start_author:this.author,start_permlink:this.permlink};this.steem.api.getDiscussionsByFeed(e,(function(e,r){r.forEach((function(e){e.permlink!=t.permlink&&t.posts.push(e)})),t.author=r[r.length-1].author,t.permlink=r[r.length-1].permlink,t.$store.commit("saveFeed",t.posts),t.isLoading=!1,1==r.length&&alert("没有更多了！")}))}},components:{Loading:N["a"]},mounted:function(){if(0!=this.$store.state.feed){this.posts=this.$store.state.feed,this.isLoading=!1;var t=this.$store.state.feed;this.author=t[t.length-1].author,this.permlink=t[t.length-1].permlink}else this.getFeed()},filters:{formatTime:function(t){return t.substring(0,10)},takeImage:function(t){var e=/!\[(.*?)\]\((.*?)\)/,r=t.match(e);if(null!==r)return r[2]},abstractFn:function(t){if(t){var e=t.replace(/(\*\*|__)(.*?)(\*\*|__)/g,"").replace(/\!\[[\s\S]*?\]\([\s\S]*?\)/g,"").replace(/\([\s\S]*?\)/g,"").replace(/<\/?.+?\/?>/g,"").replace(/http.*\w/g,"").replace(/(\*)(.*?)(\*)/g,"").replace(/`{1,2}[^`](.*?)`{1,2}/g,"").replace(/```([\s\S]*?)```[\s]*/g,"").replace(/\~\~(.*?)\~\~/g,"").replace(/[\s]*[-\*\+]+(.*)/g,"").replace(/[\s]*[0-9]+\.(.*)/g,"").replace(/(#+)(.*)/g,"").replace(/(>+)(.*)/g,"").replace(/\r\n/g,"").replace(/\n/g,"");return e.slice(0,180)}return""}}},Ft=jt,Rt=(r("08f4"),Object(u["a"])(Ft,Ct,Ot,!1,null,"53cbf95f",null)),At=Rt.exports,Pt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("h1",[t._v(t._s(t.post.title))]),r("p",{staticClass:"posttime"},[t._v("@"+t._s(t.post.author)+" "+t._s(t._f("formatTime")(t.post.created)))]),r("mavon-editor",{attrs:{value:t.post.body+"<br><br>"+t.tags+JSON.parse(t.post.json_metadata).tags.join("　"),subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,scrollStyle:t.prop.scrollStyle}}),r("br"),t.$store.state.username?r("span",{staticClass:"newreply"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.reply}},[t._v("回复")])],1):t._e(),t.flag?r("span",[t._v(" 已收藏 ")]):r("span",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.addCollection}},[t._v("收藏")])],1),t.replyFlag?r("div",[r("div",{attrs:{id:"main"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.replypost}},[t._v("提交")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e(),r("OtherReply",{attrs:{otherreply:t.areply}})],1)},Tt=[],Dt={name:"Feed",data:function(){return{db:{},post:{},data:"",flag:localStorage.getItem(this.$route.params.permlink),replyFlag:!1,text:"",areply:{},tags:"tags(标签):　"}},methods:{addCollection:function(){var t=this.$store.state.db,e=this.$store.state.username+"collection",r=t.transaction([e],"readwrite");r.oncomplete=function(t){console.log("事务操作完成")},r.onerror=function(t){console.log("事务操作出错"),console.dir(t)},r.onsuccess=function(t){console.log("事务操作成功")};var n=r.objectStore(e),a=this.post;n.add(a);var s=this.$route.params.permlink;localStorage.setItem(s,"steemjiang"),this.flag=localStorage.getItem(this.$route.params.permlink)},reply:function(){this.replyFlag=!0},replypost:function(){this.replyFlag=!1;var t=this.$store.state.password,e=this.$route.params.author,r=this.$route.params.permlink,n=this.$store.state.username,a=this.getstr(),s="",o=this.text,i=["cn","steemjiang"],l={tags:i,dapp:"steemjiang",format:"markdown"};this.postToSteem(t,e,r,n,a,s,o,l);var c={parent_author:e,parent_permlink:r,title:s,author:n,permlink:a,body:o,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(l)};this.areply=c,this.text=""},clear:function(){this.replyFlag=!1,this.text=""},uploadimg:function(t,e){this.imgAdd(t,e)}},watch:{flag:function(t){return t}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},mounted:function(){var t=this;if(0!=this.$store.state.feed){var e=this.$store.state.feed;e.forEach((function(e){e.permlink==t.$route.params.permlink&&(t.post=e)}))}else{var r=this;this.steem.api.getContent(this.$route.params.author,this.$route.params.permlink,(function(t,e){r.post=e}))}if(0==this.$store.state.posts){var n=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.initDatabase();case 2:return e=t.sent,a.$store.commit("saveDB",e),t.next=6,a.getAllPosts(e);case 6:r=t.sent,a.$store.commit("savePosts",r.reverse());case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=this;n()}},filters:{formatTime:function(t){return t.substring(0,10)}},components:{OtherReply:ct}},It=Dt,Et=(r("b835"),Object(u["a"])(It,Pt,Tt,!1,null,"59430324",null)),Lt=Et.exports,Bt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-input-group",{staticClass:"mt-3",attrs:{prepend:"作者名"}},[r("b-form-input",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchauthor(e)}},model:{value:t.author,callback:function(e){t.author=e},expression:"author"}}),r("b-input-group-append",[r("b-button",{attrs:{variant:"outline-success"},on:{click:t.searchauthor}},[t._v("搜索")])],1)],1),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 search",attrs:{id:"inline-form-input-name",placeholder:"文章关键字"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1),r("div",{staticClass:"article"},t._l(t.search(t.keywords),(function(e){return r("div",{staticClass:"content"},[r("router-link",{attrs:{to:"/search/@"+e.author+"/"+e.permlink}},[r("p",{staticClass:"posttime"},[t._v(t._s(t._f("formatTime")(e.created)))]),t._v(" "+t._s(e.title))])],1)})),0)],1)},Nt=[],Jt=(r("b4fb"),r("5c62")),qt={name:"Searchs",data:function(){return{keywords:"",author:"",isLoading:!1}},methods:{searchauthor:function(){this.isLoading=!0,this.$store.state.searchPosts=[];var t=this.author;this.steem.api.getAccountHistory(t,0,0,(function(t,e){0===e.length&&alert("用户不存在！")}));var e=this;function r(){return n.apply(this,arguments)}function n(){return n=Object(_["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.getSteemPosts(t,null,100,[]);case 2:n=r.sent,e.$store.commit("saveSearchPosts",n),e.isLoading=!1;case 5:case"end":return r.stop()}}),r)}))),n.apply(this,arguments)}r()},getSteemPosts:function(t,e,r,n){var a=this;return new Promise((function(s,o){var i=(new Date).toISOString().split(".")[0];a.steem.api.getDiscussionsByAuthorBeforeDate(t,e,i,r,(function(i,l){if(l.length>1){var c=[];l.forEach((function(t){t.permlink!=e&&c.push(t)})),n=[].concat(Object(Jt["a"])(n),c),a.getSteemPosts(t,l[l.length-1].permlink,r,n).then(s).catch(o)}else s(n)}))}))},search:function(t){var e=this.$store.state.searchPosts;return e.filter((function(e){if(e.title.includes(t))return e}))}},filters:{formatTime:function(t){return t.substring(0,10)}},components:{Loading:N["a"]}},Kt=qt,Ht=(r("fd88"),Object(u["a"])(Kt,Bt,Nt,!1,null,"06684bc8",null)),Mt=Ht.exports,Ut=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 search",attrs:{placeholder:"搜索"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),r("div",{staticClass:"article"},[t._l(t.search(t.keywords).slice(0,30),(function(e){return r("div",{staticClass:"content"},[r("router-link",{attrs:{to:"/blog/"+e.permlink}},[r("p",{staticClass:"posttime"},[t._v(t._s(t._f("formatTime")(e.created)))]),t._v(" "+t._s(e.title))])],1)})),t._l(t.search(t.keywords).slice(30),(function(e){return t.postFlag?r("div",{staticClass:"content"},[r("router-link",{attrs:{to:"/blog/"+e.permlink}},[r("p",{staticClass:"posttime"},[t._v(t._s(t._f("formatTime")(e.created)))]),t._v(" "+t._s(e.title))])],1):t._e()})),t.nextFlag?r("div",{staticClass:"btn"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.getAll}},[t._v("查看全部")])],1):t._e()],2),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1)],1)},Wt=[],zt=(r("ecb46"),{name:"Blogs",data:function(){return{keywords:"",postFlag:!1,nextFlag:!0,isLoading:!1}},methods:{getAll:function(){this.postFlag=!0,this.nextFlag=!1},getSteemPosts:function(t,e,r,n){var a=this;return new Promise((function(s,o){var i=(new Date).toISOString().split(".")[0];a.steem.api.getDiscussionsByAuthorBeforeDate(t,e,i,r,(function(i,l){if(l.length>1){var c=[];l.forEach((function(t){t.permlink!=e&&c.push(t)})),n=[].concat(Object(Jt["a"])(n),c),a.getSteemPosts(t,l[l.length-1].permlink,r,n).then(s).catch(o)}else s(n)}))}))},savePosts:function(t,e){var r=this,n=this.$store.state.username,a=t.transaction([n],"readwrite");return new Promise((function(t){a.oncomplete=function(e){console.log("111, 事务操作完成"),t()},a.onerror=function(t){console.log("事务操作出错"),console.dir(t)},a.onsuccess=function(t){console.log("222, 事务操作成功")};for(var s=a.objectStore(n),o=e.length-1;o>-1;o--)s.add(e[o]);var i=r.$store.state.username;localStorage.setItem(i,"steemjiang")}))},search:function(t){var e=this.$store.state.posts;return e.filter((function(e){if(e.title.includes(t))return e}))}},filters:{formatTime:function(t){return t.substring(0,10)}},components:{Loading:N["a"]},mounted:function(){var t=this;function e(){return r.apply(this,arguments)}function r(){return r=Object(_["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.$store.state.username){e.next=21;break}if(null!=localStorage.getItem(t.$store.state.username)){e.next=17;break}return console.log(166,"第一次登录"),t.isLoading=!0,e.next=6,t.getSteemPosts(t.$store.state.username,null,100,[]);case 6:return r=e.sent,t.$store.commit("savePosts",r),e.next=10,t.initDatabase();case 10:return n=e.sent,t.$store.commit("saveDB",n),e.next=14,t.savePosts(n,r);case 14:t.isLoading=!1,e.next=19;break;case 17:if(0!=t.$store.state.posts){e.next=19;break}return e.delegateYield(regeneratorRuntime.mark((function e(){var r,n,a,s,o,i,l,c,u,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.initDatabase();case 2:return r=e.sent,t.$store.commit("saveDB",r),e.next=6,t.getAllPosts(r);case 6:n=e.sent,t.$store.commit("savePosts",n.reverse()),a=n[0].created,s=[],n.forEach((function(t){s.push(t.permlink)})),o=t.$store.state.username,i=(new Date).toISOString().split(".")[0],l=[],c=null;case 15:return e.next=18,t.steem.api.getDiscussionsByAuthorBeforeDateAsync(o,c,i,10);case 18:if(u=e.sent,!(a<u[0].created&&-1===s.indexOf(u[0].permlink))){e.next=27;break}if(u.forEach((function(t){t.permlink!==c&&-1===s.indexOf(t.permlink)&&l.push(t)})),c=u[u.length-1].permlink,!(a>u[u.length-1].created)){e.next=25;break}return console.log(233,"没有更新的文章"),e.abrupt("break",30);case 25:e.next=28;break;case 27:return e.abrupt("break",30);case 28:e.next=15;break;case 30:if(!(l.length>0)){e.next=38;break}return e.next=33,t.savePosts(r,l);case 33:return console.log(544,"添加新文章成功！"),e.next=36,t.getAllPosts(r);case 36:p=e.sent,t.$store.commit("savePosts",p.reverse());case 38:case"end":return e.stop()}}),e)}))(),"t0",19);case 19:e.next=22;break;case 21:t.$router.push({path:"/hot"});case 22:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}e()}}),Gt=zt,Qt=(r("055b"),Object(u["a"])(Gt,Ut,Wt,!1,null,"2530918a",null)),Xt=Qt.exports,Yt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("h1",[t._v(t._s(t.post.title))]),r("p",{staticClass:"posttime"},[t._v("@"+t._s(t.post.author)+" "+t._s(t._f("formatTime")(t.post.created)))]),r("mavon-editor",{staticClass:"md",attrs:{value:t.post.body+"<br><br>"+t.tags+JSON.parse(t.post.json_metadata).tags.join("　"),subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,scrollStyle:t.prop.scrollStyle}}),r("br"),this.$store.state.username?r("div",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.edit(t.post.permlink)}}},[t._v("编辑")]),r("b-button",{attrs:{variant:"outline-primary"}},[r("a",{attrs:{target:"_blank",href:"https://steemd.com/@"+this.$store.state.username+"/"+t.post.permlink}},[t._v("文章数据")])])],1):t._e(),r("br"),r("Reply")],1)},Zt=[],Vt={name:"Blog",data:function(){return{post:{},db:{},key:"",replies:[],tags:"tags(标签):　"}},methods:{edit:function(t){this.$router.push({path:"/edit/"+t})},searchPosts:function(t){var e=this,r=this.$route.params.permlink;t.forEach((function(t){t.permlink==r&&(e.post=t)}))},searchKey:function(){var t=this,e=this.$route.params.permlink,r=this.$store.state.db,n=this.$store.state.username,a=r.transaction([n],"readwrite"),s=a.objectStore(n);s.openCursor().onsuccess=function(r){var n=r.target.result;n&&(n.value.permlink==e&&(t.key=n.key),n.continue()),s.openCursor().onerror=function(t){console.dir(t)}}}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},components:{Reply:A},filters:{formatTime:function(t){return t.substring(0,10)}},mounted:function(){var t=this;function e(){return r.apply(this,arguments)}function r(){return r=Object(_["a"])(regeneratorRuntime.mark((function e(){var r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.$store.state.username){e.next=17;break}if(0==t.$store.state.posts){e.next=7;break}r=t.$store.state.posts,t.searchPosts(r),t.searchKey(),e.next=17;break;case 7:return e.next=9,t.initDatabase();case 9:return n=e.sent,t.$store.commit("saveDB",n),e.next=13,t.getAllPosts(n);case 13:a=e.sent,t.$store.commit("savePosts",a.reverse()),t.searchPosts(a),t.searchKey();case 17:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}e()}},te=Vt,ee=(r("596c"),Object(u["a"])(te,Yt,Zt,!1,null,"58cbd9ac",null)),re=ee.exports,ne=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("h1",[t._v(t._s(t.post.title))]),r("p",{staticClass:"posttime"},[t._v("@"+t._s(t.post.author)+" "+t._s(t._f("formatTime")(t.post.created)))]),r("mavon-editor",{staticClass:"md",attrs:{value:t.post.body+"<br><br>"+t.tags+JSON.parse(t.post.json_metadata).tags.join("　"),subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,scrollStyle:t.prop.scrollStyle}}),r("br"),this.$store.state.username?r("div",[this.$store.state.username===t.post.author?r("div",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.edit(t.post.permlink)}}},[t._v("编辑")]),r("b-button",{attrs:{variant:"outline-primary"}},[r("a",{attrs:{target:"_blank",href:"https://steemd.com/@"+this.$store.state.username+"/"+t.post.permlink}},[t._v("文章数据")])]),r("br"),r("br"),r("Reply")],1):r("div",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.reply}},[t._v("回复")]),t.flag?r("span",[t._v(" 已收藏 ")]):r("span",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.addCollection}},[t._v("收藏")])],1),r("b-button",{attrs:{variant:"outline-primary"}},[r("a",{attrs:{target:"_blank",href:"https://steemd.com/@"+t.post.author+"/"+t.post.permlink}},[t._v("文章数据")])]),t.replyFlag?r("div",[r("div",{attrs:{id:"main"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.replypost}},[t._v("提交")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e(),r("br"),r("OtherReply",{attrs:{otherreply:t.areply}})],1)]):t._e()],1)},ae=[],se={name:"Article",data:function(){return{post:{},db:{},key:"",flag:localStorage.getItem(this.$route.params.permlink),areply:{},replies:[],replyFlag:!1,tags:"tags(标签):　",text:""}},methods:{addCollection:function(){var t=this.$store.state.db,e=this.$store.state.username+"collection",r=t.transaction([e],"readwrite");r.oncomplete=function(t){console.log("事务操作完成")},r.onerror=function(t){console.log("事务操作出错"),console.dir(t)},r.onsuccess=function(t){console.log("事务操作成功")};var n=r.objectStore(e),a=this.post;n.add(a);var s=this.$route.params.permlink;localStorage.setItem(s,"steemjiang"),this.flag=localStorage.getItem(this.$route.params.permlink)},edit:function(t){this.$router.push({path:"/edit/"+t})},reply:function(){this.replyFlag=!0},replypost:function(){this.replyFlag=!1;var t=this.$store.state.password,e=this.$route.params.author,r=this.$route.params.permlink,n=this.$store.state.username,a=this.getstr(),s="",o=this.text,i=["cn","steemjiang"],l={tags:i,dapp:"steemjiang",format:"markdown"};this.postToSteem(t,e,r,n,a,s,o,l);var c={parent_author:e,parent_permlink:r,title:s,author:n,permlink:a,body:o,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(l)};this.areply=c,this.text=""},clear:function(){this.replyFlag=!1,this.text=""},uploadimg:function(t,e){this.imgAdd(t,e)}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},components:{Reply:A,OtherReply:ct},filters:{formatTime:function(t){return t.substring(0,10)}},mounted:function(){var t=this,e=this.$route.params.author,r=this.$route.params.permlink;function n(){return a.apply(this,arguments)}function a(){return a=Object(_["a"])(regeneratorRuntime.mark((function n(){var a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.$store.state.username){n.next=14;break}if(0==t.$store.state.posts){n.next=5;break}t.steem.api.getContent(e,r,(function(e,r){t.post=r})),n.next=14;break;case 5:return n.next=7,t.initDatabase();case 7:return a=n.sent,t.$store.commit("saveDB",a),n.next=11,t.getAllPosts(a);case 11:s=n.sent,t.$store.commit("savePosts",s.reverse()),t.steem.api.getContent(e,r,(function(e,r){t.post=r}));case 14:case"end":return n.stop()}}),n)}))),a.apply(this,arguments)}n()}},oe=se,ie=(r("ef08"),Object(u["a"])(oe,ne,ae,!1,null,"5e05645c",null)),le=ie.exports,ce=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 search",attrs:{id:"inline-form-input-name",placeholder:"搜索"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),r("div",{staticClass:"article"},t._l(t.search(t.keywords),(function(e){return r("div",{staticClass:"content"},[r("router-link",{attrs:{to:"/collection/@"+e.author+"/"+e.permlink}},[t._v(t._s(e.title)+" "),r("p",{staticClass:"posttime"},[t._v("@"+t._s(e.author)+" "+t._s(t._f("formatTime")(e.created)))])])],1)})),0)],1)},ue=[],pe={name:"Collections",data:function(){return{keywords:""}},methods:{search:function(t){var e=this.$store.state.collections;return e.filter((function(e){if(e.title.includes(t))return e}))}},filters:{formatTime:function(t){return t.substring(0,10)}},mounted:function(){var t=this;if(0==this.$store.state.posts){var e=function(){var e=Object(_["a"])(regeneratorRuntime.mark((function e(){var r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.initDatabase();case 2:return r=e.sent,t.$store.commit("saveDB",r),e.next=6,t.getAllPosts(r);case 6:return n=e.sent,t.$store.commit("savePosts",n.reverse()),e.next=10,t.getCollections(r);case 10:a=e.sent,t.$store.commit("saveCollections",a.reverse());case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();console.log(455,"db is null"),e()}else{var r=function(){var e=Object(_["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.$store.state.db,e.next=3,t.getCollections(r);case 3:n=e.sent,t.$store.commit("saveCollections",n.reverse());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();r()}}},me=pe,de=(r("8e37"),Object(u["a"])(me,ce,ue,!1,null,"58b81b6d",null)),fe=de.exports,he=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("h1",[t._v(t._s(t.post.title))]),r("p",{staticClass:"posttime"},[t._v("@"+t._s(t.post.author)+" "+t._s(t._f("formatTime")(t.post.created)))]),r("mavon-editor",{staticClass:"md",attrs:{value:t.post.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,scrollStyle:t.prop.scrollStyle}}),t.$store.state.username?r("div",[r("b-button",{staticClass:"del",attrs:{variant:"outline-primary"},on:{click:t.del}},[t._v("取消收藏")])],1):t._e(),r("br")],1)},ge=[],ve={name:"Collection",data:function(){return{post:{},key:""}},methods:{searchKey:function(){var t=this,e=this.$route.params.permlink,r=this.$store.state.db,n=this.$store.state.username+"collection",a=r.transaction([n],"readwrite"),s=a.objectStore(n);s.openCursor().onsuccess=function(r){var n=r.target.result;n&&(n.value.permlink==e&&(t.key=n.key),n.continue()),s.openCursor().onerror=function(t){console.dir(t)}}},del:function(){var t=this.$store.state.db,e=this.$store.state.username+"collection",r=t.transaction([e],"readwrite"),n=r.objectStore(e);n.delete(this.key);var a=this.$route.params.permlink;localStorage.removeItem(a),this.$router.push("/collection")},searchPosts:function(t){var e=this,r=this.$route.params.permlink;t.forEach((function(t){t.permlink==r&&(e.post=t)}))}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},mounted:function(){var t=this;function e(){return r.apply(this,arguments)}function r(){return r=Object(_["a"])(regeneratorRuntime.mark((function e(){var r,n,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0==t.$store.state.collections){e.next=6;break}r=t.$store.state.collections,t.searchPosts(r),t.searchKey(),e.next=21;break;case 6:return console.log(99,"fresh"),e.next=9,t.initDatabase();case 9:return n=e.sent,t.$store.commit("saveDB",n),e.next=13,t.getAllPosts(n);case 13:return a=e.sent,t.$store.commit("savePosts",a.reverse()),e.next=17,t.getCollections(n);case 17:s=e.sent,t.$store.commit("saveCollections",s.reverse()),t.searchPosts(s),t.searchKey();case 21:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}e()},filters:{formatTime:function(t){return t.substring(0,10)}}},be=ve,ye=(r("fb7f"),Object(u["a"])(be,he,ge,!1,null,"2e7e8f1b",null)),ke=ye.exports,_e=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("h1",[t._v(t._s(t.post.title))]),r("p",{staticClass:"posttime"},[t._v("@"+t._s(t.post.author)+" "+t._s(t._f("formatTime")(t.post.created)))]),r("mavon-editor",{attrs:{value:t.post.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,scrollStyle:t.prop.scrollStyle}}),r("br"),t.$store.state.username?r("span",{staticClass:"newreply"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.reply}},[t._v("回复")])],1):t._e(),t.flag?r("span",[t._v(" 已收藏 ")]):r("span",[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.addCollection}},[t._v("收藏")])],1),t.replyFlag?r("div",[r("div",{attrs:{id:"main"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.replypost}},[t._v("提交")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e(),r("OtherReply",{attrs:{otherreply:t.areply}})],1)},xe=[],we={name:"Search",data:function(){return{db:{},post:{},data:"",flag:localStorage.getItem(this.$route.params.permlink),replyFlag:!1,text:"",areply:{}}},methods:{addCollection:function(){var t=this.$store.state.db,e=this.$store.state.username+"collection",r=t.transaction([e],"readwrite");r.oncomplete=function(t){console.log("事务操作完成")},r.onerror=function(t){console.log("事务操作出错"),console.dir(t)},r.onsuccess=function(t){console.log("事务操作成功")};var n=r.objectStore(e),a=this.post;n.add(a);var s=this.$route.params.permlink;localStorage.setItem(s,"steemjiang"),this.flag=localStorage.getItem(this.$route.params.permlink)},reply:function(){this.replyFlag=!0},replypost:function(){this.replyFlag=!1;var t=this.$store.state.password,e=this.$route.params.author,r=this.$route.params.permlink,n=this.$store.state.username,a=this.getstr(),s="",o=this.text,i=["cn","steemjiang"],l={tags:i,app:"steemit/1.0",format:"markdown"};this.postToSteem(t,e,r,n,a,s,o,l);var c={parent_author:e,parent_permlink:r,title:s,author:n,permlink:a,body:o,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(l)};this.areply=c,this.text=""},clear:function(){this.replyFlag=!1,this.text=""},uploadimg:function(t,e){this.imgAdd(t,e)}},watch:{flag:function(t){return t}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},mounted:function(){var t=this;if(0!=this.$store.state.searchPosts){var e=this.$store.state.searchPosts;e.forEach((function(e){e.permlink===t.$route.params.permlink&&(t.post=e)}))}else{var r=this;this.steem.api.getContent(this.$route.params.author,this.$route.params.permlink,(function(t,e){r.post=e}))}if(0==this.$store.state.posts){var n=function(){var t=Object(_["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.initDatabase();case 2:return e=t.sent,a.$store.commit("saveDB",e),t.next=6,a.getAllPosts(e);case 6:r=t.sent,a.$store.commit("savePosts",r.reverse());case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=this;n()}},filters:{formatTime:function(t){return t.substring(0,10)}},components:{OtherReply:ct}},$e=we,Se=(r("59f2"),Object(u["a"])($e,_e,xe,!1,null,"bde6f72a",null)),Ce=Se.exports,Oe=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"article"},[t._l(t.repliesreverse.slice(0,30),(function(e){return r("div",{staticClass:"content"},[r("p",{staticClass:"posttime"},[t._v("@"+t._s(e[1].op[1].author)+" "+t._s(t._f("formatTime")(e[1].timestamp)))]),r("br"),r("router-link",{attrs:{to:"/replydetail/@"+e[1].op[1].parent_author+"/"+e[1].op[1].parent_permlink+"/@"+e[1].op[1].author+"/"+e[1].op[1].permlink}},[r("mavon-editor",{attrs:{id:"replymd",value:e[1].op[1].body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}})],1)],1)})),t._l(t.repliesreverse.slice(30),(function(e){return t.replyFlag?r("div",{staticClass:"content"},[r("p",{staticClass:"posttime"},[t._v("@"+t._s(e[1].op[1].author)+" "+t._s(t._f("formatTime")(e[1].timestamp)))]),r("br"),r("router-link",{attrs:{to:"/replydetail/@"+e[1].op[1].parent_author+"/"+e[1].op[1].parent_permlink+"/@"+e[1].op[1].author+"/"+e[1].op[1].permlink}},[r("mavon-editor",{attrs:{id:"replymd2",value:e[1].op[1].body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}})],1)],1):t._e()})),t.nextFlag?r("div",{staticClass:"btn"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.getAll}},[t._v("查看全部")])],1):t._e()],2),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1)],1)},je=[],Fe={name:"ReplyToAuthor",data:function(){return{replies:[],replyFlag:!1,editFlag:!1,nextFlag:!0,isLoading:!1}},methods:{getAll:function(){this.replyFlag=!0,this.nextFlag=!1},saveReplies:function(t,e){var r=this,n=this.$store.state.username+"replytoauthor",a=t.transaction([n],"readwrite");return new Promise((function(t){a.oncomplete=function(e){console.log("123, 事务操作完成"),t()},a.onerror=function(t){console.log("事务操作出错"),console.dir(t)},a.onsuccess=function(t){console.log("222, 事务操作成功")};for(var s=a.objectStore(n),o=e.length-1;o>-1;o--)s.add(e[o]),console.log(256,"添加成功");var i=r.$store.state.username+"replytoauthor";localStorage.setItem(i,"steemjiang")}))}},filters:{formatTime:function(t){return t.substring(0,10)}},computed:{repliesreverse:function(){return this.$store.state.repliestoauthor},prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},components:{Loading:N["a"]},mounted:function(){var t=this,e=this.$store.state.username,r=this.$store.state.username+"replytoauthor";function n(t,e){return a.apply(this,arguments)}function a(){return a=Object(_["a"])(regeneratorRuntime.mark((function e(r,n){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=[],e.next=3,t.steem.api.getAccountHistoryAsync(r,-1,n);case 3:return s=e.sent,s.forEach((function(t){"comment"==t[1].op[0]&t[1].op[1].parent_author==r&&a.push(t)})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}function s(){return o.apply(this,arguments)}function o(){return o=Object(_["a"])(regeneratorRuntime.mark((function a(){var s,o,i,l,c,u,p,m,d,f,h,g,v,b,y;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.$store.state.username){a.next=65;break}if(null!=localStorage.getItem(r)){a.next=14;break}return t.isLoading=!0,a.next=5,n(e,3e3);case 5:return s=a.sent,t.$store.commit("saveRepliesToAuthor",s.reverse()),o=t.$store.state.db,a.next=10,t.saveReplies(o,s);case 10:t.isLoading=!1,console.log("评论存入数据库成功！"),a.next=65;break;case 14:if(0!=t.$store.state.posts){a.next=44;break}return console.log("345，刷新或数据库没开"),a.next=18,t.initDatabase();case 18:return i=a.sent,t.$store.commit("saveDB",i),a.next=22,t.getAllPosts(i);case 22:return l=a.sent,t.$store.commit("savePosts",l.reverse()),a.next=26,t.getRepliesToAuthor(i);case 26:return c=a.sent,t.$store.commit("saveRepliesToAuthor",c.reverse()),u=c[0][1].block,a.next=31,n(e,500);case 31:if(p=a.sent,m=[],p.forEach((function(t){u<t[1].block&&(console.log(22,"有新评论"),m.push(t))})),!(m.length>0)){a.next=42;break}return a.next=37,t.saveReplies(i,m.reverse());case 37:return console.log(566,"添加新评论成功！"),a.next=40,t.getRepliesToAuthor(i);case 40:d=a.sent,t.$store.commit("saveRepliesToAuthor",d.reverse());case 42:a.next=65;break;case 44:if(0!=t.$store.state.repliestoauthor){a.next=65;break}return console.log("444，获得数据库并读取评论"),f=t.$store.state.db,a.next=49,t.getRepliesToAuthor(f);case 49:return h=a.sent,t.$store.commit("saveRepliesToAuthor",h.reverse()),g=h[0][1].block,a.next=54,n(e,500);case 54:if(v=a.sent,b=[],v.forEach((function(t){g<t[1].block&&(console.log(33,"有新评论"),b.push(t))})),!(b.length>0)){a.next=65;break}return a.next=60,t.saveReplies(f,b.reverse());case 60:return console.log(577,"添加新评论成功！"),a.next=63,t.getRepliesToAuthor(f);case 63:y=a.sent,t.$store.commit("saveRepliesToAuthor",y.reverse());case 65:case"end":return a.stop()}}),a)}))),o.apply(this,arguments)}s()}},Re=Fe,Ae=(r("40c8"),Object(u["a"])(Re,Oe,je,!1,null,"012d4da2",null)),Pe=Ae.exports,Te=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("router-link",{attrs:{to:"/@"+t.onereply.root_author+"/"+t.onereply.root_permlink}},[r("h1",[t._v("原文："+t._s(t.onereply.root_title)+" ")])]),t._v(" 父评论： "),r("p",[t._v("@"+t._s(t.parentreply.author)+" "+t._s(t._f("formatTime")(t.parentreply.created)))]),r("mavon-editor",{staticClass:"replymd",attrs:{value:t.parentreply.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}}),r("div",{staticClass:"child"},[r("p",[t._v("@"+t._s(t.onereply.author)+" "+t._s(t._f("formatTime")(t.onereply.created)))]),r("mavon-editor",{staticClass:"replymd",attrs:{value:t.onereply.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}}),this.$store.state.username?r("span",{staticClass:"newreply"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.reply}},[t._v("回复")])],1):t._e(),t.replyFlag?r("div",[r("div",{attrs:{id:"main"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.replypost}},[t._v("提交")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e()],1),t.newreplyFlag?r("div",{staticClass:"secchild"},[r("p",[t._v("@"+t._s(t.newreply.author)+" "+t._s(t._f("formatTime")(t.newreply.created)))]),r("mavon-editor",{staticClass:"replymd",attrs:{value:t.newreply.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}}),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.edit()}}},[t._v("编辑")]),t.editFlag?r("div",[r("div",{attrs:{id:"main2"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.imgAdd},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.refresh(t.newreply)}}},[t._v("更新")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e()],1):t._e()],1)},De=[],Ie={name:"ReplyDetail",data:function(){return{db:{},data:"",flag:localStorage.getItem(this.$route.params.permlink),replyFlag:!1,editFlag:!1,text:"",areply:{},onereply:{},parentreply:{},newreply:{},newreplyFlag:!1,tags:"tags(标签):　"}},methods:{reply:function(){this.replyFlag=!0},replypost:function(){this.replyFlag=!1;var t=this.$store.state.password,e=this.$route.params.author,r=this.$route.params.permlink,n=this.$store.state.username,a=this.getstr(),s="",o=this.text,i=["cn","steemjiang"],l={tags:i,app:"steemit/1.0",format:"markdown"};this.postToSteem(t,e,r,n,a,s,o,l);var c={parent_author:e,parent_permlink:r,title:s,author:n,permlink:a,body:o,created:(new Date).toISOString().split(".")[0],json_metadata:JSON.stringify(l)};this.newreply=c,this.newreplyFlag=!0,this.text=""},edit:function(){this.editFlag=!0,this.text=this.newreply.body},refresh:function(t){this.editFlag=!1,this.$set(t,"body",this.text);var e=this.$store.state.password,r=this.$store.state.username,n=t.parent_author,a=t.parent_permlink,s=t.permlink,o=t.title,i=this.text,l=t.json_metadata;this.postToSteem(e,n,a,r,s,o,i,l)},clear:function(){this.replyFlag=!1,this.text=""},uploadimg:function(t,e){this.imgAdd(t,e)}},watch:{flag:function(t){return t}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},mounted:function(){var t=this;this.steem.api.getContent(this.$route.params.parent_author,this.$route.params.parent_permlink,(function(e,r){t.parentreply=r})),this.steem.api.getContent(this.$route.params.author,this.$route.params.permlink,(function(e,r){t.onereply=r}))},filters:{formatTime:function(t){return t.substring(0,10)}},components:{OtherReply:ct}},Ee=Ie,Le=(r("05c0"),Object(u["a"])(Ee,Te,De,!1,null,"167a7178",null)),Be=Le.exports,Ne=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"article"},[t._l(t.comments,(function(e){return r("div",{staticClass:"content"},[r("p",{staticClass:"posttime"},[t._v("@"+t._s(e.author)+" "+t._s(t._f("formatTime")(e.created)))]),r("router-link",{attrs:{to:"/commentdetail/@"+e.parent_author+"/"+e.parent_permlink+"/@"+e.author+"/"+e.permlink}},[r("mavon-editor",{attrs:{id:"replymd",value:e.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}})],1)],1)})),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1),r("div",{staticClass:"btn"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.getNext}},[t._v("查看更多")])],1)],2)])},Je=[],qe={name:"Comments",data:function(){return{comments:[],permlink:"",isLoading:!0}},methods:{getComments:function(){var t=this,e=this.$store.state.username,r={limit:30,start_author:e,start_permlink:""};this.steem.api.getDiscussionsByComments(r,(function(e,r){t.comments=r,t.permlink=r[r.length-1].permlink,t.isLoading=!1}))},getNext:function(){var t=this;t.isLoading=!0;var e=this.$store.state.username;t.isLoading=!0;var r={limit:30,start_author:e,start_permlink:this.permlink};this.steem.api.getDiscussionsByComments(r,(function(e,r){r.forEach((function(e){e.permlink!=t.permlink&&t.comments.push(e)})),t.permlink=r[r.length-1].permlink,t.isLoading=!1,1==r.length&&alert("没有更多了！")}))}},filters:{formatTime:function(t){return t.substring(0,10)}},computed:{repliesreverse:function(){return this.$store.state.repliestoauthor},prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},components:{Loading:N["a"]},mounted:function(){this.getComments()}},Ke=qe,He=(r("12b6"),Object(u["a"])(Ke,Ne,Je,!1,null,"cfc7dcde",null)),Me=He.exports,Ue=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("router-link",{attrs:{to:"/@"+t.onereply.root_author+"/"+t.onereply.root_permlink}},[r("h1",[t._v("原文："+t._s(t.onereply.root_title)+" ")])]),t._v(" 父评论： "),r("p",[t._v("@"+t._s(t.parentreply.author)+" "+t._s(t._f("formatTime")(t.parentreply.created)))]),r("mavon-editor",{staticClass:"replymd",attrs:{value:t.parentreply.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}}),r("div",{staticClass:"child"},[r("p",[t._v("@"+t._s(t.onereply.author)+" "+t._s(t._f("formatTime")(t.onereply.created)))]),r("mavon-editor",{staticClass:"replymd",attrs:{value:t.onereply.body,subfield:t.prop.subfield,defaultOpen:t.prop.defaultOpen,toolbarsFlag:t.prop.toolbarsFlag,editable:t.prop.editable,boxShadow:!1,scrollStyle:t.prop.scrollStyle}}),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.edit()}}},[t._v("编辑")]),t.editFlag?r("div",[r("div",{attrs:{id:"main2"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:t.uploadimg},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),r("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.refresh(t.onereply)}}},[t._v("更新")]),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.clear}},[t._v("取消")])],1):t._e()],1)],1)},We=[],ze={name:"CommentDetail",data:function(){return{db:{},data:"",flag:localStorage.getItem(this.$route.params.permlink),replyFlag:!1,editFlag:!1,text:"",onereply:{},parentreply:{}}},methods:{edit:function(){this.editFlag=!0,this.text=this.onereply.body},refresh:function(t){this.editFlag=!1,this.$set(t,"body",this.text);var e=this.$store.state.password,r=this.$store.state.username,n=t.parent_author,a=t.parent_permlink,s=t.permlink,o=t.title,i=this.text,l=t.json_metadata;this.postToSteem(e,n,a,r,s,o,i,l)},clear:function(){this.editFlag=!1,this.text=""},uploadimg:function(t,e){this.imgAdd(t,e)}},watch:{flag:function(t){return t}},computed:{prop:function(){var t={subfield:!1,defaultOpen:"preview",editable:!1,toolbarsFlag:!1,scrollStyle:!0};return t}},mounted:function(){var t=this;this.steem.api.getContent(this.$route.params.parent_author,this.$route.params.parent_permlink,(function(e,r){t.parentreply=r})),this.steem.api.getContent(this.$route.params.author,this.$route.params.permlink,(function(e,r){t.onereply=r}))},filters:{formatTime:function(t){return t.substring(0,10)}},components:{OtherReply:ct}},Ge=ze,Qe=(r("2940"),Object(u["a"])(Ge,Ue,We,!1,null,"f647d400",null)),Xe=Qe.exports,Ye=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Ze=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("h1",[t._v("关于百灵界")]),t._v(" 百灵界是一个基于以太坊的区块链世界，它可以做自媒体，发布你的观点和视频。 同时它还具有集市和威客的功能，会在后面慢慢开发！"),r("br"),r("br"),t._v(" 百灵界启用自己发行的代币LARK，会按一定的规则分发。 ")])}],Ve={name:"About",data:function(){return{}},mounted:function(){}},tr=Ve,er=(r("f1f7"),Object(u["a"])(tr,Ye,Ze,!1,null,"1bbfa89e",null)),rr=er.exports,nr=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},ar=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"content"}},[r("h1",[t._v("新手指南")]),r("div",{staticClass:"newtext"})])}],sr={name:"Newbie",data:function(){return{}},mounted:function(){}},or=sr,ir=(r("6dce"),Object(u["a"])(or,nr,ar,!1,null,"1ecd1577",null)),lr=ir.exports,cr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"login"},[r("h2",[t._v("钱包")]),t.flag?r("div",[t._v(" 地址： "+t._s(t.addr)+" "),r("br"),t._v(" 余额： "+t._s(t.balanceOf)+" LARK"),r("br"),r("br"),r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.beforetransfer}},[t._v("转帐")]),t.transferFlag?r("div",[r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 user",attrs:{placeholder:"地址"},model:{value:t.to,callback:function(e){t.to=e},expression:"to"}}),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 user",attrs:{placeholder:"金额"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),r("div",{staticClass:"loginbtn"},[r("b-button",{attrs:{variant:"outline-primary"},on:{click:t.transfer}},[t._v("确认转帐")])],1)],1):t._e()],1):t._e(),r("transition",{attrs:{name:"fade"}},[t.isLoading?r("loading"):t._e()],1)],1)},ur=[],pr=(r("513c"),{name:"Login",data:function(){return{nickname:"",addr:"",balanceOf:"",password:"",isLoading:!1,flag:!0,totalSupply:"",to:"",value:"",transferFlag:!1}},methods:{beforetransfer:function(){this.transferFlag=!this.transferFlag},transfer:function(){this.isLoading=!0,this.transferFlag=!1;var t=this,e=this.web3.utils.toWei(this.value,"ether"),r=this.$store.state.addr,n=this.$store.state.walletinstance;function a(){return s.apply(this,arguments)}function s(){return s=Object(_["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,n.transfer(t.to,e,{from:r});case 2:a.sent,t.isLoading=!1,t.$router.go(0);case 5:case"end":return a.stop()}}),a)}))),s.apply(this,arguments)}a()},dealNumber:function(t){if(t&&null!=t){t=String(t);var e=t.split(".")[0],r=t.split(".")[1];r=r?r.length>=2?"."+r.substr(0,2):"."+r+"0":".00";var n=e.split("").reverse().join("").match(/(\d{1,3})/g);return(Number(t)<0?"-":"")+n.join(",").split("").reverse().join("")+r}return 0===t?"0.00":""}},components:{Loading:N["a"]},mounted:function(){this.web3.utils.BN;var t=this,e=this.addr=this.$store.state.addr;function r(){return n.apply(this,arguments)}function n(){return n=Object(_["a"])(regeneratorRuntime.mark((function r(){var n,a,s,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.axios.get("LarkToken.json");case 2:return n=r.sent,a=t.TruffleContract(n.data),a.setProvider(t.web3Provider),r.next=7,a.deployed();case 7:return s=r.sent,t.$store.commit("saveWalletInstance",s),r.next=11,s.balanceOf(e);case 11:return r.t0=r.sent,o=1e-18*r.t0,t.balanceOf=t.dealNumber(o),r.next=16,s.totalSupply();case 16:r.t1=r.sent,i=1e-18*r.t1,t.totalSupply=t.dealNumber(i),t.isLoading=!1;case 20:case"end":return r.stop()}}),r)}))),n.apply(this,arguments)}r()}}),mr=pr,dr=(r("d4f2"),Object(u["a"])(mr,cr,ur,!1,null,"af2feb1c",null)),fr=dr.exports,hr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"article"},[r("button",{on:{click:t.getEventWeb3}},[t._v("获取日志")]),r("br"),r("button",{on:{click:t.getSign}},[t._v("获取签名")]),r("br"),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 user",attrs:{placeholder:"转帐地址"},model:{value:t.to,callback:function(e){t.to=e},expression:"to"}}),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0 user",attrs:{placeholder:"eth",eth:""},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),r("button",{on:{click:t.sendTransaction}},[t._v("转帐")])],1)},gr=[],vr={name:"Index",data:function(){return{to:"",value:""}},methods:{getEthLogs:function(){var t=this;function e(){return r.apply(this,arguments)}function r(){return r=Object(_["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(888,t.ethapi),e.next=3,t.ethapi.log.getLogs("0x98C59036C71Ef10684b3A4a3ffA85b280fe7b402",7745600,"latest");case 3:r=e.sent,console.log(2263,r);case 5:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}e()},getEventWeb3:function(){console.log(566,this.web3),console.log(567,this.web3.eth),console.log(568,this.web3.eth.accounts);var t=this.$store.state.instance;function e(){return r.apply(this,arguments)}function r(){return r=Object(_["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getPastEvents("SetContent",{fromBlock:0,toBlock:"latest"});case 2:r=e.sent,console.log(8855,r),console.log(8856,r[0].returnValues[0]);case 5:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}e()},getSign:function(){this.web3.utils.sha3("message to sign");var t=this.$store.state.addr,e=this;var r="0xCD7324469cC6d4DF5BfdaEaDBCDDb008866F0913",n=4e14,a=12,s="0xD952e0c02F5D6D77c0207daAb436F3540a99B511";function o(){return i.apply(this,arguments)}function i(){return i=Object(_["a"])(regeneratorRuntime.mark((function o(){var i,l;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return console.log(899,r),i="0x"+e.abi.soliditySHA3(["address","uint256","uint256","address"],[r,n,a,s]).toString("hex"),console.log(566,i),o.next=5,e.web3.eth.personal.sign(i,t);case 5:l=o.sent,console.log(699,l);case 7:case"end":return o.stop()}}),o)}))),i.apply(this,arguments)}o()},sendTransaction:function(){var t=this;console.log(456,1e18*this.value);var e=this.$store.state.addr;function r(){return n.apply(this,arguments)}function n(){return n=Object(_["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.web3.eth.sendTransaction({from:e,to:t.to,value:1e18*t.value});case 2:n=r.sent,console.log(899,n);case 4:case"end":return r.stop()}}),r)}))),n.apply(this,arguments)}r()}},components:{}},br=vr,yr=(r("4e3e"),Object(u["a"])(br,hr,gr,!1,null,"2b70e294",null)),kr=yr.exports;n["default"].use(E["a"]);var _r=[{path:"/",name:"index",component:Q,meta:{requireAuth:!0}},{path:"/@:author/:permlink",name:"article",component:le},{path:"/test",name:"test",component:kr},{path:"/trend/:author/:permlink",name:"trend",component:dt},{path:"/feeds",name:"feeds",component:At,meta:{requireAuth:!0}},{path:"/searchs",name:"searchs",component:Mt},{path:"/blogs",name:"blogs",component:Xt,meta:{requireAuth:!0}},{path:"/blog/:permlink",name:"blog",component:re},{path:"/search/@:author/:permlink",name:"search",component:Ce},{path:"/collections",name:"collections",component:fe,meta:{requireAuth:!0}},{path:"/collection/@:author/:permlink",name:"collection",component:ke},{path:"/feed/@:author/:permlink",name:"feed",component:Lt},{path:"/category",name:"category",component:b,meta:{requireAuth:!0}},{path:"/wallet",name:"wallet",component:fr},{path:"/login",name:"login",component:H},{path:"/reply",name:"replytoauthor",component:Pe,meta:{requireAuth:!0}},{path:"/comments",name:"comments",component:Me,meta:{requireAuth:!0}},{path:"/about",name:"about",component:rr},{path:"/newbie",name:"newbie",component:lr},{path:"/replydetail/@:parent_author/:parent_permlink/@:author/:permlink",name:"replydetail",component:Be},{path:"/commentdetail/@:parent_author/:parent_permlink/@:author/:permlink",name:"commentdetail",component:Xe},{path:"/post",name:"post",component:yt,meta:{requireAuth:!0}},{path:"/edit/:permlink",name:"edit",component:St,meta:{requireAuth:!0}}],xr=new E["a"]({mode:"history",base:"/",routes:_r}),wr=xr,$r=r("ae8c"),Sr=r("022b"),Cr=r.n(Sr);n["default"].use($r["a"]);var Or,jr,Fr=new $r["a"].Store({state:{nickname:Cr.a.get("nickname"),addr:Cr.a.get("addr"),posts:[],db:{},instance:{},walletinstance:{},feed:[],hot:[],collections:[],searchPosts:[],repliestoauthor:[]},mutations:{saveUser:function(t,e){t.nickname=e.nickname,t.addr=e.addr,Cr.a.set("nickname",e.nickname,"1d"),Cr.a.set("addr",e.addr,"1d")},savePosts:function(t,e){t.posts=e},saveRepliesToAuthor:function(t,e){t.repliestoauthor=e},saveFeed:function(t,e){t.feed=e},saveHot:function(t,e){t.hot=e},saveCollections:function(t,e){t.collections=e},saveSearchPosts:function(t,e){t.searchPosts=e},saveDB:function(t,e){t.db=e},saveInstance:function(t,e){t.instance=e},saveWalletInstance:function(t,e){t.walletinstance=e},clearUser:function(t){t.nickname=null,t.addr=null,Cr.a.remove("nickname"),Cr.a.remove("addr")}}}),Rr=r("6483"),Ar=(r("df63"),r("f46b"),r("6f2f")),Pr=r.n(Ar),Tr=(r("b2ab"),r("79b2")),Dr=r.n(Tr),Ir=r("82ae"),Er=r.n(Ir),Lr=r("2d97"),Br=r.n(Lr),Nr=r("344c"),Jr=r.n(Nr),qr=r("7742"),Kr=r.n(qr),Hr=function(){function t(t,e){for(var r="",n=t;n>0;--n)r+=e[Math.floor(Math.random()*e.length)];return r}return t(5,"0123456789abcdefghijklmnopqrstuvwxyz")},Mr=r("a352"),Ur=function(){var t,e,r=this.$store.state.username,n=this.$store.state.username,a=this.$store.state.username+"collection",s=this.$store.state.username+"reply",o=this.$store.state.username+"comments",i=this.$store.state.username+"replytoauthor",l=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB;return l||alert("你的浏览器不支持IndexedDB"),new Promise((function(c){e=l.open(r,3),e.onupgradeneeded=function(e){if(t=e.target.result,!t.objectStoreNames.contains(n)){var r=t.createObjectStore(n,{keyPath:"id",autoIncrement:!0});r.createIndex("title","title",{unique:!1})}if(!t.objectStoreNames.contains(a)){var l=t.createObjectStore(a,{keyPath:"id",autoIncrement:!0});l.createIndex("title","title",{unique:!1})}if(!t.objectStoreNames.contains(s)){var c=t.createObjectStore(s,{keyPath:"id",autoIncrement:!0});c.createIndex("title","title",{unique:!1})}if(!t.objectStoreNames.contains(o)){var u=t.createObjectStore(o,{keyPath:"id",autoIncrement:!0});u.createIndex("title","title",{unique:!1})}if(!t.objectStoreNames.contains(i))t.createObjectStore(i,{keyPath:"id",autoIncrement:!0})},e.onsuccess=function(e){t=e.target.result,console.log(666,"db版本号",t.version),t.onerror=function(t){alert("Database error:"+t.target.errorCode),console.dir(t.target)},c(t)},e.onerror=function(t){console.log(t,"数据库打开错误")}}))},Wr=function(t){var e=this.$store.state.username,r=t.transaction([e],"readwrite"),n=r.objectStore(e),a=[];return new Promise((function(t){n.openCursor().onsuccess=function(e){var r=e.target.result;r?(a.push(r.value),r.continue()):t(a)},n.openCursor().onerror=function(t){console.dir(t)}}))},zr=function(t){var e=this.$store.state.username+"reply",r=t.transaction([e],"readwrite"),n=r.objectStore(e),a=[];return new Promise((function(t){n.openCursor().onsuccess=function(e){var r=e.target.result;r?(a.push(r.value),r.continue()):t(a)},n.openCursor().onerror=function(t){console.dir(t)}}))},Gr=function(t){var e=this.$store.state.username+"collection",r=t.transaction([e],"readwrite"),n=r.objectStore(e),a=[];return new Promise((function(t){n.openCursor().onsuccess=function(e){var r=e.target.result;r?(a.push(r.value),r.continue()):t(a)},n.openCursor().onerror=function(t){console.dir(t)}}))},Qr=function(t){var e=this.$store.state.username+"replytoauthor",r=t.transaction([e],"readwrite"),n=r.objectStore(e),a=[];return new Promise((function(t){n.openCursor().onsuccess=function(e){var r=e.target.result;r?(a.push(r.value),r.continue()):t(a)},n.openCursor().onerror=function(t){console.dir(t)}}))},Xr=function(t,e,r){return new Promise((function(n){var a=e.transaction([r],"readwrite");a.oncomplete=function(t){console.log("536, 事务操作完成"),n()},a.onerror=function(t){console.log("事务操作出错"),console.dir(t)},a.onsuccess=function(t){console.log("事务操作成功")};var s=a.objectStore(r);s.add(t)}))};n["default"].use(Rr["a"]),n["default"].use(Pr.a),"undefined"!==typeof window.ethereum?(console.log(111,"metamask"),jr=window.ethereum,Or=new Jr.a(window.ethereum)):(console.log(222,"无metamask"),alert("没有安装metamask！\n 请安装！ https://metamask.io "));var Yr=Dr()({host:"steemjiang.com",port:"9001",protocol:"https"});n["default"].prototype.ipfs=Yr;var Zr=r("71d8").init("DYX36PF9I32G7TDQDFF97CSK24SXWZXIN9","ropsten","3000");n["default"].prototype.getstr=Hr,n["default"].prototype.imgAdd=Mr["a"],n["default"].prototype.initDatabase=Ur,n["default"].prototype.getAllPosts=Wr,n["default"].prototype.getAllReplies=zr,n["default"].prototype.getCollections=Gr,n["default"].prototype.getRepliesToAuthor=Qr,n["default"].prototype.saveOneToDb=Xr,n["default"].prototype.TruffleContract=Br.a,n["default"].prototype.web3=Or,n["default"].prototype.web3Provider=jr,n["default"].prototype.axios=Er.a,n["default"].prototype.ethapi=Zr,n["default"].prototype.abi=Kr.a,n["default"].config.productionTip=!1,new n["default"]({router:wr,store:Fr,render:function(t){return t(I)}}).$mount("#app"),wr.beforeEach((function(t,e,r){t.meta.requireAuth?Fr.state.nickname?r():r({name:"login"}):r()}))},"58cc":function(t,e,r){},"596c":function(t,e,r){"use strict";var n=r("cbef"),a=r.n(n);a.a},"59f2":function(t,e,r){"use strict";var n=r("80a1"),a=r.n(n);a.a},"5a12":function(t,e,r){},6:function(t,e){},"66e3":function(t,e,r){},6877:function(t,e,r){},"6dce":function(t,e,r){"use strict";var n=r("66e3"),a=r.n(n);a.a},"6ded":function(t,e,r){},7:function(t,e){},7870:function(t,e,r){},"7b7d":function(t,e,r){},"7c84":function(t,e,r){},"7f16":function(t,e,r){"use strict";var n=r("990c"),a=r.n(n);a.a},"7f3b":function(t,e,r){"use strict";(function(t){r("fe8a"),r("e35a"),r("0d7a"),r("6db4"),r("b449");var n=r("5d83"),a=r("3a5e");e["a"]={name:"Post",data:function(){return{db:{},body:"",title:"",keywords:"",isLoading:!1,flag:!1}},methods:{post:function(){this.flag=!1,this.isLoading=!0;var e=this.$store.state.nickname,r=this.$store.state.instance,a=this.$store.state.addr,s=this.getstr(),o=this.title,i=this.body,l=this.keywords.trim().split(/\s+/),c={keywords:l,dapp:"etherjiang",format:"markdown"},u=this;function p(){return m.apply(this,arguments)}function m(){return m=Object(n["a"])(regeneratorRuntime.mark((function n(){var p,m,d,f;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return p={title:o,nickname:e,addr:a,category:"etherjiang",permlink:s,body:i,created:(new Date).toISOString().split(".")[0],json_metadata:c},m=t.from(JSON.stringify(p)),n.next=4,u.ipfs.add(m);case 4:return d=n.sent,n.next=7,r.set(d[0].hash,o,JSON.stringify(l),{from:a});case 7:f=n.sent,console.log(955,f),u.$store.commit("saveHot",[]),u.$router.push({path:"/"});case 11:case"end":return n.stop()}}),n)}))),m.apply(this,arguments)}p()},get:function(){var t=this,e="QmZEBDS4Sh9Yhr48rUSLKMbyPDsr4rvRZXmAsfwEVfgHtG";function r(){return a.apply(this,arguments)}function a(){return a=Object(n["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.ipfs.cat(e);case 2:n=r.sent,a=t.utf8ArrayToStr(n),console.log(688,a);case 5:case"end":return r.stop()}}),r)}))),a.apply(this,arguments)}r()},utf8ArrayToStr:function(t){var e,r,n,a,s,o;e="",n=t.length,r=0;while(r<n)switch(a=t[r++],a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(a);break;case 12:case 13:s=t[r++],e+=String.fromCharCode((31&a)<<6|63&s);break;case 14:s=t[r++],o=t[r++],e+=String.fromCharCode((15&a)<<12|(63&s)<<6|(63&o)<<0);break}return e},uploadimg:function(t,e){this.imgAdd(t,e)}},components:{Loading:a["a"]},mounted:function(){var t=this,e=this.$store.state.instance;this.$store.state.addr;function r(){return a.apply(this,arguments)}function a(){return a=Object(n["a"])(regeneratorRuntime.mark((function r(){var n,a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t.$store.state.nickname){r.next=15;break}if(0!==Object.keys(e).length){r.next=14;break}return r.next=4,t.axios.get("Post.json");case 4:return n=r.sent,a=t.TruffleContract(n.data),a.setProvider(t.web3.currentProvider),r.next=9,a.deployed();case 9:s=r.sent,t.$store.commit("saveInstance",s),t.flag=!0,r.next=15;break;case 14:t.flag=!0;case 15:case"end":return r.stop()}}),r)}))),a.apply(this,arguments)}r()}}}).call(this,r("fd40").Buffer)},8:function(t,e){},"80a1":function(t,e,r){},"838e":function(t,e,r){"use strict";var n=r("ffdb"),a=r.n(n);a.a},"8e37":function(t,e,r){"use strict";var n=r("5611"),a=r.n(n);a.a},9:function(t,e){},"990c":function(t,e,r){},"9ad2":function(t,e,r){},"9e0d":function(t,e,r){"use strict";var n=r("58cc"),a=r.n(n);a.a},a0da:function(t,e,r){"use strict";var n=r("7b7d"),a=r.n(n);a.a},a352:function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return n}));r("e18c");var n=function(e,r){var n="https://steemjiang.com:8081/ipfs/",a=this,s=function(e){return new Promise((function(r,n){var s=t.from(e.result);a.ipfs.add(s).then((function(t){r(t[0].hash)})).catch((function(t){console.error(t),n(t)}))}))},o=new FileReader;o.readAsArrayBuffer(r),o.onloadend=function(t){s(o).then((function(t){a.$refs.md.$img2Url(e,n+t)}))}}}).call(this,r("fd40").Buffer)},a3ec:function(t,e,r){},a4c8:function(t,e,r){"use strict";var n=r("9ad2"),a=r.n(n);a.a},abc0:function(t,e){function r(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}r.keys=function(){return[]},r.resolve=r,t.exports=r,r.id="abc0"},b08d:function(t,e,r){},b835:function(t,e,r){"use strict";var n=r("38ac"),a=r.n(n);a.a},bb39:function(t,e,r){"use strict";var n=r("e62b"),a=r.n(n);a.a},c073:function(t,e,r){"use strict";var n=r("ce5e"),a=r.n(n);a.a},c9bb:function(t,e,r){},cbef:function(t,e,r){},ce5e:function(t,e,r){},d4f2:function(t,e,r){"use strict";var n=r("0f9b"),a=r.n(n);a.a},d7a1:function(t,e,r){t.exports=r.p+"img/logo.5c9d8489.svg"},e1b2:function(t,e,r){"use strict";var n=r("e248"),a=r.n(n);a.a},e1bb:function(t,e,r){},e248:function(t,e,r){},e5c8:function(t,e,r){},e62b:function(t,e,r){},ef08:function(t,e,r){"use strict";var n=r("6ded"),a=r.n(n);a.a},f0a2:function(t,e,r){},f1f7:function(t,e,r){"use strict";var n=r("a3ec"),a=r.n(n);a.a},f3bb:function(t,e,r){},f47f:function(t,e,r){"use strict";var n=r("b08d"),a=r.n(n);a.a},f534:function(t,e,r){},f8a4:function(t,e,r){},fb7f:function(t,e,r){"use strict";var n=r("f0a2"),a=r.n(n);a.a},fd88:function(t,e,r){"use strict";var n=r("c9bb"),a=r.n(n);a.a},ffdb:function(t,e,r){}});
//# sourceMappingURL=app.37b84792.js.map